{
  "db": "PostgreSQL",
  "16ca7142a2eb5be1e7aa5ce65eb7d473d1f7745c4673be17d3cce42bfbb23d8d": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Text"
        },
        {
          "name": "name",
          "ordinal": 1,
          "type_info": "Text"
        },
        {
          "name": "created_at",
          "ordinal": 2,
          "type_info": "Timestamptz"
        },
        {
          "name": "updated_at",
          "ordinal": 3,
          "type_info": "Timestamptz"
        },
        {
          "name": "archived_at",
          "ordinal": 4,
          "type_info": "Timestamptz"
        },
        {
          "name": "user_id",
          "ordinal": 5,
          "type_info": "Text"
        },
        {
          "name": "sort_number",
          "ordinal": 6,
          "type_info": "Int8"
        }
      ],
      "nullable": [
        false,
        false,
        false,
        false,
        true,
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Text",
          "Text"
        ]
      }
    },
    "query": "\n            select * from habits\n            where user_id = $1\n            and id = $2\n            "
  },
  "1ba006cb5a51a99e86be9e6ed6b69f7e9e543f327cc1b26aa12f0331117ca059": {
    "describe": {
      "columns": [
        {
          "name": "archived!",
          "ordinal": 0,
          "type_info": "Bool"
        },
        {
          "name": "id",
          "ordinal": 1,
          "type_info": "Text"
        },
        {
          "name": "name",
          "ordinal": 2,
          "type_info": "Text"
        }
      ],
      "nullable": [
        null,
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Text",
          "Date"
        ]
      }
    },
    "query": "\n                select archived_at is not null \"archived!\", id, name from habits\n                where user_id = $1\n                and (archived_at is null or archived_at > ($2::date)::timestamp at time zone 'Asia/Tokyo')\n                and created_at < ($2::date)::timestamp at time zone 'Asia/Tokyo' + interval '1 day'\n                order by sort_number\n                "
  },
  "359f06ec34c19bc5f2bd44368d682c255aba20b463b5abdf016d62d7b81ce9fd": {
    "describe": {
      "columns": [
        {
          "name": "done?",
          "ordinal": 0,
          "type_info": "Bool"
        },
        {
          "name": "archived!",
          "ordinal": 1,
          "type_info": "Bool"
        },
        {
          "name": "habit_id",
          "ordinal": 2,
          "type_info": "Text"
        },
        {
          "name": "habit_name",
          "ordinal": 3,
          "type_info": "Text"
        }
      ],
      "nullable": [
        false,
        null,
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Text",
          "Date"
        ]
      }
    },
    "query": "\n                select h_d_r.done \"done?\", h.archived_at is not null \"archived!\", h.id habit_id, h.name habit_name from habits h\n                left outer join habit_daily_records h_d_r\n                on h.id = h_d_r.habit_id\n                and h_d_r.recorded_on = $2\n                where h.user_id = $1\n                and (h.archived_at is null or h.archived_at > ($2::date)::timestamp at time zone 'Asia/Tokyo')\n                and h.created_at < ($2::date)::timestamp at time zone 'Asia/Tokyo' + interval '1 day'\n                order by h.sort_number\n                "
  },
  "37dcfa3633f727c0f4037cf17ab03e93496958aed7a5776cba20514909f50089": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Text"
        },
        {
          "name": "comment",
          "ordinal": 1,
          "type_info": "Text"
        },
        {
          "name": "recorded_on",
          "ordinal": 2,
          "type_info": "Date"
        }
      ],
      "nullable": [
        false,
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Text",
          "Date"
        ]
      }
    },
    "query": "\n        select id, comment, recorded_on from daily_records\n        where user_id = $1\n        and recorded_on = $2\n        "
  },
  "773f17279b2eb9bd1268e2d5222a78441adaa145ea7ea932f584abbf625e1298": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Text"
        },
        {
          "name": "comment",
          "ordinal": 1,
          "type_info": "Text"
        },
        {
          "name": "recorded_on",
          "ordinal": 2,
          "type_info": "Date"
        },
        {
          "name": "created_at",
          "ordinal": 3,
          "type_info": "Timestamptz"
        },
        {
          "name": "updated_at",
          "ordinal": 4,
          "type_info": "Timestamptz"
        },
        {
          "name": "user_id",
          "ordinal": 5,
          "type_info": "Text"
        }
      ],
      "nullable": [
        false,
        false,
        false,
        false,
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Text",
          "Date"
        ]
      }
    },
    "query": "\n            select * from daily_records\n            where user_id = $1\n            and recorded_on = $2\n            "
  },
  "83e41cb0bd7f1cb7db074b17750d7ffe8fd2388cce26d42b19d767d3adf946ff": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Text"
        },
        {
          "name": "done",
          "ordinal": 1,
          "type_info": "Bool"
        },
        {
          "name": "recorded_on",
          "ordinal": 2,
          "type_info": "Date"
        },
        {
          "name": "created_at",
          "ordinal": 3,
          "type_info": "Timestamptz"
        },
        {
          "name": "updated_at",
          "ordinal": 4,
          "type_info": "Timestamptz"
        },
        {
          "name": "habit_id",
          "ordinal": 5,
          "type_info": "Text"
        },
        {
          "name": "daily_record_id",
          "ordinal": 6,
          "type_info": "Text"
        }
      ],
      "nullable": [
        false,
        false,
        false,
        false,
        false,
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Text"
        ]
      }
    },
    "query": "\n            select * from habit_daily_records\n            where daily_record_id = $1\n            "
  },
  "a09c1ef0c1047498fc0c908cb33f2fd473a0b3b2c82c419504435f183aa41162": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Text"
        },
        {
          "name": "name",
          "ordinal": 1,
          "type_info": "Text"
        },
        {
          "name": "created_at",
          "ordinal": 2,
          "type_info": "Timestamptz"
        },
        {
          "name": "updated_at",
          "ordinal": 3,
          "type_info": "Timestamptz"
        },
        {
          "name": "archived_at",
          "ordinal": 4,
          "type_info": "Timestamptz"
        },
        {
          "name": "user_id",
          "ordinal": 5,
          "type_info": "Text"
        },
        {
          "name": "sort_number",
          "ordinal": 6,
          "type_info": "Int8"
        }
      ],
      "nullable": [
        false,
        false,
        false,
        false,
        true,
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Text",
          "Date"
        ]
      }
    },
    "query": "\n            select * from habits\n            where user_id = $1\n            and (archived_at is null or archived_at > ($2::date)::timestamp at time zone 'Asia/Tokyo')\n            and created_at < ($2::date)::timestamp at time zone 'Asia/Tokyo' + interval '1 day'\n            order by sort_number\n            "
  },
  "e8325a41fcfe1ec5ca2709eb4e0e3d29fc06ac80e5ac55f5d28528398f19162b": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Text"
        },
        {
          "name": "name",
          "ordinal": 1,
          "type_info": "Text"
        },
        {
          "name": "archived!",
          "ordinal": 2,
          "type_info": "Bool"
        },
        {
          "name": "created_at",
          "ordinal": 3,
          "type_info": "Timestamptz"
        },
        {
          "name": "recent_done_list!",
          "ordinal": 4,
          "type_info": "BoolArray"
        }
      ],
      "nullable": [
        false,
        false,
        null,
        false,
        null
      ],
      "parameters": {
        "Left": [
          "Text",
          "Bool"
        ]
      }
    },
    "query": "\n        select\n        habits.id, habits.name, habits.archived_at is not null \"archived!\", habits.created_at, array_agg(coalesce(habit_daily_records.done, false)) \"recent_done_list!\"\n        from\n        (\n            select\n            *\n            from\n            habits,\n            (\n                select\n                generate_series(\n                    current_date::timestamp at time zone 'Asia/Tokyo' - interval '5 days',\n                    current_date::timestamp at time zone 'Asia/Tokyo' + interval '1 days',\n                    '1 day'\n                ) _timestamp\n            ) last_days\n            where habits.created_at < last_days._timestamp\n            and user_id = $1\n            and ($2::bool is null or (case when $2 then archived_at is not null else archived_at is null end))\n        ) habits\n        left outer join habit_daily_records\n        on habits.id = habit_daily_records.habit_id\n        and habits._timestamp::date = habit_daily_records.recorded_on\n        group by habits.id, habits.name, habits.archived_at, habits.created_at, habits.sort_number\n        order by habits.sort_number\n        "
  }
}